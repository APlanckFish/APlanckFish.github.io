---
title: 关于字典的初次运用
date: 2016-12-29 14:31:51
tags: 自动处理
categories: 开发心得
---
　　上次的excel处理程序还存在一定的问题。经过王慧妍童鞋的用户反馈，在打印期初数据的过程中，打印顺序跟单位名称不一致。在前面的版本中，我先没有考虑到这个问题。这个问题产生的原因是
<!-- more-->

	while y<len(cols2):
	i=worksheet.cell(y,5).value
	g=worksheet.cell(y,4).value
	if worksheet.cell(y,4).value in SameList:
	InitValue.append(i)
	SameList2.append(g)
	y+=1
	elif worksheet.cell(y,4).value in DfrList2:
	InitValue2.append(i)
	y+=1
	else:
	y+=1

这段代码先前没有InitValue2这个列表，通过if in遍历之后只能找出cols2这个列表里存在的SameList的单位，但是没有办法跟先前的遍历保持同一顺序。因此在这段改进后的代码中，我加入了一个新的列表SameList2。该列表与之前的SameList元素相同，顺序有差异。
　　这个时候，我想到了字典的运用。思路是将SameList2（单位名称）作为键，InitValue（期初）作为值，将其一一对应。然后用for each in遍历SameList，然后新建一个列表InitValue3来存储调整后的期初值。代码如下：

	dic=dict(zip(SameList2,InitValue))
	InitValue3 = []
	for each in SameList:
	InitValue3.append(dic[each])

　　最后在打印时，直接打印InitValue3就可以了。经测试果然成功了。由于无期初有发生额与有期初无发生额不存在遍历两次顺序不一致的问题，因此不需做调整。